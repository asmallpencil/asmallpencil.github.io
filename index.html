
<!DOCTYPE html>
<html>
<head>
    <title>铅笔博客:施工中...</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            touch-action: none;
        }
        #gameTitle {
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 24px;
        }
        canvas {
            border: 1px solid #333;
        }
    </style>
</head>
<body>
    <h1 id="gameTitle">铅笔站开发中</h1>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // 设置画布尺寸
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - 80;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // 游戏对象
        const player = {
            x: canvas.width/2,
            y: canvas.height - 30,
            width: 40,
            height: 20,
            angle: 0
        };

        let enemies = [];
        let bullets = [];
        let touchX = 0;
        let isTouching = false;

        // 触摸事件处理
        canvas.addEventListener('touchstart', (e) => {
            isTouching = true;
            touchX = e.touches[0].clientX;
        });

        canvas.addEventListener('touchmove', (e) => {
            touchX = e.touches[0].clientX;
        });

        canvas.addEventListener('touchend', () => {
            isTouching = false;
        });

        // 生成敌人
        function spawnEnemy() {
            enemies.push({
                x: Math.random() * (canvas.width - 30),
                y: 0,
                width: 30,
                height: 30,
                health: 1
            });
        }

        // 游戏循环
        function gameLoop() {
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // 更新玩家角度（改进灵敏度）
            if(isTouching) {
                const dx = touchX - player.x;
                // 修改角度计算公式，使用固定小值提高灵敏度
                player.angle = Math.atan2(-100, dx); // dy固定为-1
            }

            // 生成敌人
            if(Math.random() < 0.2) spawnEnemy();

            // 更新子弹（移除数量限制）
            bullets.forEach((bullet, index) => {
                bullet.x += bullet.speed * Math.cos(bullet.angle);
                bullet.y += bullet.speed * Math.sin(bullet.angle);
                
                // 子弹边界检测
                if(bullet.y < 0 || bullet.x < 0 || bullet.x > canvas.width) {
                    bullets.splice(index, 1);
                }
            });

            // 更新敌人
            enemies.forEach((enemy, index) => {
                enemy.y += 2;
                
                // 敌人边界检测
                if(enemy.y > canvas.height) {
                    enemies.splice(index, 1);
                }

                // 碰撞检测
                bullets.forEach((bullet, bIndex) => {
                    if(
                        bullet.x > enemy.x &&
                        bullet.x < enemy.x + enemy.width &&
                        bullet.y > enemy.y &&
                        bullet.y < enemy.y + enemy.height
                    ) {
                        enemy.health--;
                        bullets.splice(bIndex, 1);
                    }
                });

                if(enemy.health <= 0) {
                    enemies.splice(index, 1);
                }
            });

            // 自动射击（无限子弹）
            bullets.push({
                x: player.x,
                y: player.y,
                speed: 20, // 速度提升到20
                angle: player.angle
            });

            // 绘制玩家
            ctx.fillStyle = '#666';
            ctx.fillRect(player.x - player.width/2, player.y, player.width, player.height);
            
            // 绘制瞄准线
            if(isTouching) {
                ctx.beginPath();
                ctx.moveTo(player.x, player.y);
                ctx.lineTo(
                    player.x + Math.cos(player.angle) * 1000, // 延长瞄准线
                    player.y + Math.sin(player.angle) * 1000
                );
                ctx.strokeStyle = 'rgba(255,255,255,0.5)'; // 更醒目的瞄准线
                ctx.lineWidth = 3;
                ctx.stroke();
            }

            // 绘制子弹
            ctx.fillStyle = 'yellow';
            bullets.forEach(bullet => {
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 3, 0, Math.PI*2);
                ctx.fill();
            });

            // 绘制敌人
            ctx.fillStyle = 'red';
            enemies.forEach(enemy => {
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            });

            requestAnimationFrame(gameLoop);
        }

        // 启动游戏
        gameLoop();
    </script>
</body>
</html>
